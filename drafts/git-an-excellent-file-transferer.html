<!doctype html><html lang=en><title>Git - An Excellent File Transferer - Terminal In A Simputer Archives</title><meta charset=utf-8><link rel=canonical href=https://archives.snorl.ax/drafts/git-an-excellent-file-transferer.html><link href=https://archives.snorl.ax/theme/css/all.css rel=stylesheet><link rel=dns-prefetch href=https://fonts.googleapis.com><link rel=dns-prefetch href=https://fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Luckiest+Guy|Rajdhani:600|Rajdhani:700&amp;display=swap"><link href=https://archives.snorl.ax/theme/images/icon.png rel=icon><link href=https://archives.snorl.ax/theme/images/icon-apple.png rel=apple-touch-icon-precomposed><link href=https://archives.snorl.ax/feeds/all.xml rel=alternate title="Simputer Archives RSS Feed" type=application/rss+xml><meta content=git name=tags><meta content=file name=tags><meta content=ssh name=tags><meta content="width=device-width" name=viewport><meta name=twitter:card content=summary><meta name=twitter:image content=https://archives.snorl.ax/theme/images/usual-twitter.png><meta name=twitter:site content=@Snorl_ax><meta name=twitter:title content="Git - An Excellent File Transferer"><meta name=twitter:description content="I recently found that git is an excellent file transferer."><div id=a><header id=c><div id=d><h1 id=e><a href=https://archives.snorl.ax/>Simputer Archives</a></h1></div></header><div id=f><nav id=h><ul><li><a href=https://archives.snorl.ax/>Home</a><li><a href=https://archives.snorl.ax/browser/>Browser</a><li id=i><a href=https://archives.snorl.ax/terminal/>Terminal</a><li><a href=https://archives.snorl.ax/tags/>Tags</a></ul></nav><nav id=r><a href=https://www.youtube.com/channel/UCnqOLMtPJaqa7e_6FhZ8-rw title=Youtube><svg id="youtube"/></a><a href=https://github.com/SnorlaxYum/ title=Github><svg id="github"/></a><a href=https://twitter.com/Snorl_ax title=Twitter><svg id="twitter"/></a><a href=https://archives.snorl.ax/feeds/all.xml title=RSS><svg id="rss"/></a><a href=mailto:sim@snorl.ax title=Email><svg id="mail"/></a></nav><aside id=j><form action=https://archives.snorl.ax/search.html onsubmit="return validateForm(this.elements['q'].value);"><input placeholder=Search... name=q id=tipue_search_input></form></aside></div></div><div id=b><main id=k><article id=m><header id=o><h2 id=p>Git - An Excellent File Transferer</h2></header><div id=n><p>I did migration of my site from firebase to my server. And then I found out that git is far more better than scp. Normally scp transfer files one by one to the server, while git glues all files together, speeding up the process. Afterwards, the version control will take care of the changes of the whole git project and only process the changes to the server.<p>I did through the official guide 4.3<sup id=fnref:1><a class=footnote-ref href=#fn:1 rel=footnote>1</a></sup> and 4.4<sup id=fnref:2><a class=footnote-ref href=#fn:2 rel=footnote>2</a></sup> and created a user <code>git</code> for doing git.<p>However doing without a git account is also possible.<h2 id=toc>Table Of Contents</h2><div class=toc><ul><li><a href=#working-with-a-remote>Working with a remote</a><li><a href=#working-with-multiple-remotes>Working with multiple remotes</a></ul></div><h2 id=working-with-a-remote><a class=toclink href=#working-with-a-remote>Working with a remote</a></h2><p>Generate my own SSH public key on my local computer:<div class=highlight><pre><span class=code-line><span></span>$ ssh-keygen</span>
</pre></div><p>Upload my ~/.ssh/id_rsa.pub to somewhere on the server:<div class=highlight><pre><span class=code-line><span></span>sim@localhost:~$ scp -P port ~/.ssh/id_rsa.pub sim@server:/home/sim/id_rsa.sim.pub</span>
</pre></div><p>On the server in the home, make dir for ssh if <code>.ssh</code> hasn't been created:<div class=highlight><pre><span class=code-line><span></span>sim@server:~$ mkdir .ssh</span>
</pre></div><p>append the key to <code>authorized_keys</code>:<div class=highlight><pre><span class=code-line><span></span>sim@server:~$ cat id_rsa.sim.pub &gt;&gt; .ssh/authorized_keys</span>
</pre></div><p>Initialize a new dir for new git project:<div class=highlight><pre><span class=code-line><span></span>sim@server:~$ git init --bare new_dir.git</span>
</pre></div><p>On my local computer:<div class=highlight><pre><span class=code-line><span></span>sim@localhost:~$ cd project</span>
<span class=code-line>sim@localhost:~/project$ git init &amp;&amp; git add . &amp;&amp; git commit -m &quot;initial commit&quot; &amp;&amp; git remote add origin ssh://sim@server:port:/home/sim/new_dir.git &amp;&amp; git push origin master</span>
</pre></div><p>Then on the server, I can do this:<div class=highlight><pre><span class=code-line><span></span>sim@server:~$ git clone ~/new_dir.git ~/new_dir</span>
</pre></div><p><code>new_dir</code> is a new dir with all files checked out from the git project <code>new_dir.git</code> and the git settings.<p>I could create <code>~/new_dir.git/hooks/post-receive</code>:<div class=highlight><pre><span class=code-line><span></span><span class=ch>#!/bin/sh</span></span>
<span class=code-line><span class=nb>cd</span> /home/sim/new_dir <span class=o>||</span> <span class=nb>exit</span></span>
<span class=code-line><span class=nb>unset</span> GIT_DIR</span>
<span class=code-line>git pull origin master</span>
</pre></div><p>The <code>unset</code> is needed 'cause git uses the variable <code>GIT_DIR</code> instead of <code>PWD</code>, <code>cd</code> changes <code>PWD</code> instead of <code>GIT_DIR</code>. There must be a fallback from <code>GIT_DIR</code> to <code>PWD</code><sup id=fnref:3><a class=footnote-ref href=#fn:3 rel=footnote>3</a></sup>.<p>Make it executable:<div class=highlight><pre><span class=code-line><span></span>sim@server:~$ chmod +x ~/new_dir.git/hooks/post-receive</span>
</pre></div><p>Everytime I need update files on the server, I could do it via a bash:<div class=highlight><pre><span class=code-line><span></span><span class=ch>#!/bin/bash</span></span>
<span class=code-line><span class=nb>cd</span> /home/sim/project</span>
<span class=code-line><span class=nb>echo</span> -n <span class=s2>&quot;Enter the commit message: &quot;</span></span>
<span class=code-line><span class=nb>read</span> message</span>
<span class=code-line>git add .</span>
<span class=code-line>git commit -m <span class=s2>&quot;</span><span class=si>${</span><span class=nv>message</span><span class=si>}</span><span class=s2>&quot;</span></span>
<span class=code-line>git push origin master</span>
</pre></div><p>Then everytime I push to the git project, the <code>new_dir</code> will be also updated with new contents.<h2 id=working-with-multiple-remotes><a class=toclink href=#working-with-multiple-remotes>Working with multiple remotes</a></h2><p>Sometimes I need to work with serveral remotes, for example, I need to upload to multiple servers, then I have to do some extra things.<p>Upload my ~/.ssh/id_rsa.pub to somewhere on another server:<div class=highlight><pre><span class=code-line><span></span>sim@localhost:~$ scp -P port ~/.ssh/id_rsa.pub sim@server2:/home/sim/id_rsa.sim.pub</span>
</pre></div><p>On the server in the home, make dir for ssh if <code>.ssh</code> hasn't been created:<div class=highlight><pre><span class=code-line><span></span>sim@server2:~$ mkdir .ssh</span>
</pre></div><p>Append the key to <code>authorized_keys</code>:<div class=highlight><pre><span class=code-line><span></span>sim@server2:~$ cat id_rsa.sim.pub &gt;&gt; .ssh/authorized_keys</span>
</pre></div><p>Initialize a new dir for new git project:<div class=highlight><pre><span class=code-line><span></span>sim@server2:~$ git init --bare new_dir.git</span>
</pre></div><p>On my local computer:<div class=highlight><pre><span class=code-line><span></span>sim@localhost:~$ cd project</span>
<span class=code-line>sim@localhost:~/project$ git remote add origin2 ssh://sim@server2:port:/home/sim/new_dir.git</span>
<span class=code-line>sim@localhost:~/project$ git push origin2 master</span>
</pre></div><p>Then on the server, I can do this:<div class=highlight><pre><span class=code-line><span></span>sim@server2:~$ git clone ~/new_dir.git ~/new_dir</span>
</pre></div><p><code>new_dir</code> is a new dir with all files checked out from the git project <code>new_dir.git</code> and the git settings.<p>I could create <code>~/new_dir.git/hooks/post-receive</code>:<div class=highlight><pre><span class=code-line><span></span><span class=ch>#!/bin/sh</span></span>
<span class=code-line><span class=nb>cd</span> /home/sim/new_dir <span class=o>||</span> <span class=nb>exit</span></span>
<span class=code-line><span class=nb>unset</span> GIT_DIR</span>
<span class=code-line>git stash</span>
<span class=code-line>git pull origin master</span>
</pre></div><p>Make it executable:<div class=highlight><pre><span class=code-line><span></span>sim@server2:~$ chmod +x ~/new_dir.git/hooks/post-receive</span>
</pre></div><p>Everytime I need update files on both servers, I could do it via a bash:<div class=highlight><pre><span class=code-line><span></span><span class=ch>#!/bin/bash</span></span>
<span class=code-line><span class=nb>cd</span> /home/sim/project</span>
<span class=code-line><span class=nb>echo</span> -n <span class=s2>&quot;Enter the commit message: &quot;</span></span>
<span class=code-line><span class=nb>read</span> message</span>
<span class=code-line>git add .</span>
<span class=code-line>git commit -m <span class=s2>&quot;</span><span class=si>${</span><span class=nv>message</span><span class=si>}</span><span class=s2>&quot;</span></span>
<span class=code-line>git push origin master</span>
<span class=code-line>git push origin2 master</span>
</pre></div><p>Then everytime I push to both git projects, the <code>new_dir</code> on both servers will be also updated with new contents.<div class=footnote><hr><ol><li id=fn:1><p><a href=https://git-scm.com/book/en/v2/Git-on-the-Server-Generating-Your-SSH-Public-Key>Git - Generating Your SSH Public Key</a>&#160;<a class=footnote-backref href=#fnref:1 rev=footnote title="Jump back to footnote 1 in the text">&#8617;</a><li id=fn:2><p><a href=https://git-scm.com/book/en/v2/Git-on-the-Server-Setting-Up-the-Server>Git - Setting Up the Server</a>&#160;<a class=footnote-backref href=#fnref:2 rev=footnote title="Jump back to footnote 2 in the text">&#8617;</a><li id=fn:3><p><a href=https://stackoverflow.com/a/4100577/9850945>githooks - getting "fatal: not a git repository: '.'" when using post-update hook to execute 'git pull' on another repo - Stack Overflow</a>&#160;<a class=footnote-backref href=#fnref:3 rev=footnote title="Jump back to footnote 3 in the text">&#8617;</a></ol></div></div><footer id=q><svg id="publish"/><b>Created:&nbsp;</b><time datetime=2019-06-07T22:08:00+02:00>June 07, 2019</time><span id=y>•</span><svg id="edit"/><b>Updated:&nbsp;</b><time datetime=2019-07-31T18:28:00+02:00>July 31, 2019</time><span id=y>•</span><svg id="session"/></svg>In a <a href=https://archives.snorl.ax/terminal/ rel="category tag"><b>Terminal</b></a> Session<span id=y>•</span><svg id="tags"/><b>Tags:&nbsp;</b><a href=https://archives.snorl.ax/tags/git/ rel=tag>git</a>,&nbsp;<a href=https://archives.snorl.ax/tags/file/ rel=tag>file</a>,&nbsp;<a href=https://archives.snorl.ax/tags/ssh/ rel=tag>ssh</a></footer></article><article id=m><div id=n><section id=comments data-title="Git - An Excellent File Transferer" data-isso-id=/drafts/git-an-excellent-file-transferer.html></section></div></article></main></div><footer id=g><div id=l>Simputer Archives &#169; 2016 - 2019 (<a href=https://snorl.ax/>Click to view Current Version of Simputer</a>) • Licensed under <a target=_blank rel=license href=http://creativecommons.org/licenses/by/3.0/>CC BY 3.0</a><br>Made using <a href=http://getpelican.com/ target=_blank>Pelican</a> • Design from <a href=https://wordpress.org/themes/twentyfifteen/ target=_blank>TwentyFifteen</a></div></footer><script data-isso=https://isso.snorl.ax/ data-isso-gravatar=true data-isso-avatar=false data-isso-reply-notifications=true data-isso-reply-to-self=true data-isso-css=false src=https://archives.snorl.ax/theme/js/isso_embed.min.js data-isso-lang=en></script>