<!doctype html><html lang=en><title>Updated to Debian Buster - Terminal In A Simputer Archives</title><meta charset=utf-8><link rel=canonical href=https://archives.snorl.ax/drafts/updated-to-debian-buster.html><link href=https://archives.snorl.ax/theme/css/all.css rel=stylesheet><link rel=dns-prefetch href=https://fonts.googleapis.com><link rel=dns-prefetch href=https://fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Luckiest+Guy|Rajdhani:600|Rajdhani:700&amp;display=swap"><link href=https://archives.snorl.ax/theme/images/icon.png rel=icon><link href=https://archives.snorl.ax/theme/images/icon-apple.png rel=apple-touch-icon-precomposed><link href=https://archives.snorl.ax/feeds/all.xml rel=alternate title="Simputer Archives RSS Feed" type=application/rss+xml><meta content=Debian name=tags><meta content=Buster name=tags><meta content=openssl name=tags><meta content=dovecot name=tags><meta content="width=device-width" name=viewport><meta name=twitter:card content=summary><meta name=twitter:image content=https://archives.snorl.ax/theme/images/usual-twitter.png><meta name=twitter:site content=@Snorl_ax><meta name=twitter:title content="Updated to Debian Buster"><meta name=twitter:description content="Some packages changed and needed some changes."><div id=a><header id=c><div id=d><h1 id=e><a href=https://archives.snorl.ax/>Simputer Archives</a></h1></div></header><div id=f><nav id=h><ul><li><a href=https://archives.snorl.ax/>Home</a><li><a href=https://archives.snorl.ax/browser/>Browser</a><li id=i><a href=https://archives.snorl.ax/terminal/>Terminal</a><li><a href=https://archives.snorl.ax/tags/>Tags</a></ul></nav><nav id=r><a href=https://www.youtube.com/channel/UCnqOLMtPJaqa7e_6FhZ8-rw title=Youtube><svg id="youtube"/></a><a href=https://github.com/SnorlaxYum/ title=Github><svg id="github"/></a><a href=https://twitter.com/Snorl_ax title=Twitter><svg id="twitter"/></a><a href=https://archives.snorl.ax/feeds/all.xml title=RSS><svg id="rss"/></a><a href=mailto:sim@snorl.ax title=Email><svg id="mail"/></a></nav><aside id=j><form action=https://archives.snorl.ax/search.html onsubmit="return validateForm(this.elements['q'].value);"><input placeholder=Search... name=q id=tipue_search_input></form></aside></div></div><div id=b><main id=k><article id=m><header id=o><h2 id=p>Updated to Debian Buster</h2></header><div id=n><h2 id=toc>Table Of Contents</h2><div class=toc><ul><li><a href=#update-to-debian-buster>Update To Debian Buster</a><li><a href=#dovecot-dh-key-too-small>Dovecot: dh key too small</a></ul></div><h2 id=update-to-debian-buster><a class=toclink href=#update-to-debian-buster>Update To Debian Buster</a></h2><p><code>/etc/apt/sources.list</code>:<div class=highlight><pre><span class=code-line><span></span><span class=k>deb</span> <span class=s>http://debian-mirror.westus.cloudapp.azure.com/debian/</span> <span class=kp>buster</span> <span class=kp>main</span></span>
<span class=code-line><span class=k>deb-src</span> <span class=s>http://debian-mirror.westus.cloudapp.azure.com/debian/</span> <span class=kp>buster</span> <span class=kp>main</span></span>
<span class=code-line></span>
<span class=code-line><span class=k>deb</span> <span class=s>http://security.debian.org/</span> <span class=kp>buster/updates</span> <span class=kp>main</span></span>
<span class=code-line><span class=k>deb-src</span> <span class=s>http://security.debian.org/</span> <span class=kp>buster/updates</span> <span class=kp>main</span></span>
<span class=code-line></span>
<span class=code-line><span class=k>deb</span> <span class=s>http://debian-mirror.westus.cloudapp.azure.com/debian/</span> <span class=kp>buster-backports</span> <span class=kp>main</span></span>
<span class=code-line></span>
<span class=code-line><span class=k>deb</span> <span class=s>http://nginx.org/packages/mainline/debian/</span> <span class=kp>buster</span> <span class=kp>nginx</span></span>
<span class=code-line><span class=k>deb-src</span> <span class=s>http://nginx.org/packages/mainline/debian/</span> <span class=kp>buster</span> <span class=kp>nginx</span></span>
<span class=code-line></span>
<span class=code-line><span class=k>deb</span> <span class=s>http://debian-mirror.westus.cloudapp.azure.com/debian/</span> <span class=kp>buster-updates</span> <span class=kp>main</span></span>
<span class=code-line><span class=k>deb-src</span> <span class=s>http://debian-mirror.westus.cloudapp.azure.com/debian/</span> <span class=kp>buster-updates</span> <span class=kp>main</span></span>
</pre></div><p>In the configuration file above I replaced <code>stretch</code> with buster.<p>In my case I found files in <code>/etc/apt/sources.list.d/</code> too so I did similar changes there.<p>Then upgrade:<div class=highlight><pre><span class=code-line><span></span>sim@server:~$ sudo apt update &amp;&amp; sudo apt upgrade &amp;&amp; sudo apt dist-upgrade</span>
</pre></div><p>Answer to the prompts in the process. Then it's done.<h2 id=dovecot-dh-key-too-small><a class=toclink href=#dovecot-dh-key-too-small>Dovecot: dh key too small</a></h2><p>Upon update, I can't log in to my imap anymore with the following log:<div class=highlight><pre><span class=code-line><span></span>Jun 17 06:37:01 server dovecot: imap-login: Error: Failed to initialize SSL server context: Can&#39;t load DH parameters: error:1408518A:SSL routines:ssl3_ctx_ctrl:dh key too small: user=&lt;&gt;, rip=*.*.*.*, lip=*.*.*.*, session=&lt;eUofjH2LSO2wer5W&gt;</span>
</pre></div><p>It's because from version 2.3 I must specify path to DH parameters file using<sup id=fnref:1><a class=footnote-ref href=#fn:1 rel=footnote>1</a></sup>:<div class=highlight><pre><span class=code-line><span></span>ssl_dh=&lt;/path/to/dh.pem</span>
</pre></div><p>So to resolve this:<div class=highlight><pre><span class=code-line><span></span>sim@server:~$ su</span>
<span class=code-line>root@server:~$ openssl dhparam 4096 &gt; /var/mail/dh.pem</span>
</pre></div><p>In <code>/etc/dovecot/conf.d/10-ssl.conf</code>, specidy this:<div class=highlight><pre><span class=code-line><span></span>...</span>
<span class=code-line>ssl_dh=&lt;/var/mail/dh.pem</span>
<span class=code-line>...</span>
</pre></div><p>Specifying this is recommended as well:<div class=highlight><pre><span class=code-line><span></span>...</span>
<span class=code-line>ssl_prefer_server_ciphers=yes</span>
<span class=code-line>...</span>
</pre></div><p>Then restart:<div class=highlight><pre><span class=code-line><span></span>root@server:~$ systemctl restart dovecot</span>
</pre></div><p>Now I'm able to log in to my imap again.<div class=footnote><hr><ol><li id=fn:1><p><a href=https://wiki.dovecot.org/SSL/DovecotConfiguration>SSL/DovecotConfiguration - Dovecot Wiki</a>&#160;<a class=footnote-backref href=#fnref:1 rev=footnote title="Jump back to footnote 1 in the text">&#8617;</a></ol></div></div><footer id=q><svg id="publish"/><b>Created:&nbsp;</b><time datetime=2019-06-17T13:30:00+02:00>June 17, 2019</time><span id=y>•</span><svg id="edit"/><b>Updated:&nbsp;</b><time datetime=2019-08-05T17:49:00+02:00>August 05, 2019</time><span id=y>•</span><svg id="session"/></svg>In a <a href=https://archives.snorl.ax/terminal/ rel="category tag"><b>Terminal</b></a> Session<span id=y>•</span><svg id="tags"/><b>Tags:&nbsp;</b><a href=https://archives.snorl.ax/tags/debian/ rel=tag>Debian</a>,&nbsp;<a href=https://archives.snorl.ax/tags/buster/ rel=tag>Buster</a>,&nbsp;<a href=https://archives.snorl.ax/tags/openssl/ rel=tag>openssl</a>,&nbsp;<a href=https://archives.snorl.ax/tags/dovecot/ rel=tag>dovecot</a></footer></article><article id=m><div id=n><section id=comments data-title="Updated to Debian Buster" data-isso-id=/drafts/updated-to-debian-buster.html></section></div></article></main></div><footer id=g><div id=l>Simputer Archives &#169; 2016 - 2019 (<a href=https://snorl.ax/>Click to view Current Version of Simputer</a>) • Licensed under <a target=_blank rel=license href=http://creativecommons.org/licenses/by/3.0/>CC BY 3.0</a><br>Made using <a href=http://getpelican.com/ target=_blank>Pelican</a> • Design from <a href=https://wordpress.org/themes/twentyfifteen/ target=_blank>TwentyFifteen</a></div></footer><script data-isso=https://isso.snorl.ax/ data-isso-gravatar=true data-isso-avatar=false data-isso-reply-notifications=true data-isso-reply-to-self=true data-isso-css=false src=https://archives.snorl.ax/theme/js/isso_embed.min.js data-isso-lang=en></script>